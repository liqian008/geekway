<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bruce.geekway.dao.mapper.WxMaterialMapper">

	<!-- 查询指定commandId的material列表 -->
	<select id="queryMaterialsByCommandId" resultMap="BaseResultMap">
		select <include refid="Material_Base_Column_List" /> from wx_material wm, wx_command_material wcm where wcm.material_id = wm.id and wcm.command_id=#{commandId,jdbcType=INTEGER} order by wcm.top_time desc;
	</select>
	
	
	<!-- limit查询指定commandId的material列表 -->
	<select id="queryMaterialsByCommandIdLimit" resultMap="BaseResultMap">
		select <include refid="Material_Base_Column_List" /> from wx_material wm, wx_command_material wcm where wcm.material_id = wm.id and wcm.command_id=#{commandId} order by wcm.top_time desc limit #{limit};
	</select> 
	 
	
	<!-- 查询不在commandId中的material列表，供添加 -->
	<select id="queryMaterialsOutCommandId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select <include refid="Material_Base_Column_List" /> from wx_material wm where wm.id not in (select material_id from wx_command_material where command_id=#{commandId,jdbcType=INTEGER}) order by wm.create_time desc;
	</select> 
	
	
	
	<sql id="Material_Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 29 09:29:23 CST 2014.
    -->
    wm.id, wm.material_type, wm.message_id, wm.title, wm.short_title, wm.short_content, wm.content, wm.link, 
    wm.status, wm.cover_image_url, wm.cover_thumb_image_url, wm.create_time, wm.update_time
    
  </sql>
	
</mapper>